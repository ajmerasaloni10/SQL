http://www.artfulsoftware.com/infotree/qrytip.php?id=78


http://sqlfiddle.com/#!9/a67fd3/6
http://sqlfiddle.com/#!9/778ccb/2
https://www.techonthenet.com/sql_server/pivot.php
http://sqlfiddle.com/#!18/7c919/2